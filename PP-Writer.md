# Position Paper Writer - Layer Structure

This document defines the 4-layer hierarchy for building a position paper. Each layer breaks down the previous layer into more specific components.

---

## Layer 1: Final Paper Structure

The complete position paper consists of 5 paragraphs:

1. **Intro Paragraph**
2. **Background Paragraph**
3. **Position Paragraph**
4. **Solutions Paragraph**
5. **Conclusion Paragraph**

---

## Layer 2: Paragraph Components

Each paragraph breaks down into its constituent sections.

### Intro Paragraph
1. Intro Sentence
2. Broad Context
3. Acknowledge Alternate Perspective
4. Call to Action
5. Thesis Statement

### Background Paragraph
1. Intro Sentence
2. Key Fact #1
3. Analysis of Fact #1
4. Key Fact #2
5. Analysis of Fact #2
6. Summary

### Position Paragraph
1. Intro Sentence
2. Position Statement
3. Evidence
4. Analysis
5. Reasoning

### Solutions Paragraph
1. Intro Sentence
2. Solution Proposal
3. Evidence
4. Connection to Solution
5. Alternate Solution

### Conclusion Paragraph
1. Summary of Key Evidence
2. Summary of Position
3. Summary of Proposed Solution

---

## Layer 3: Idea Formation

This layer bridges raw research (Layer 4) and polished sentences (Layer 2). Students combine fragments, notes, and bullet points into coherent ideas that express a complete thought.

**The goal:** Turn scattered research into a clear claim or statement that can then be written as a formal sentence.

### Intro Paragraph Ideas

| For Section → | Form This Idea | By Combining These (from L4) |
|---------------|----------------|------------------------------|
| Intro Sentence | A hook that grabs attention and names the topic | Topic Definition + a striking statistic or question |
| Broad Context | Why this matters: who's affected, how long it's been a problem, how widespread | Affected Populations + Timeline + Current Situation |
| Acknowledge Alternate Perspective | What opponents believe and why it's understandable | Points of Contention + Competing Interests |
| Call to Action | Why we must act now, not later | Recent Developments + Barriers to Progress |
| Thesis Statement | Your country's main argument in one idea | Country's Position + Country's Interests + hint at solution |

### Background Paragraph Ideas

| For Section → | Form This Idea | By Combining These (from L4) |
|---------------|----------------|------------------------------|
| Intro Sentence | What background the reader needs to understand | Topic Definition + Scope |
| Key Fact #1 | One important fact that shows the problem's scale or severity | Key Statistics OR Present State |
| Analysis of Fact #1 | What that fact means—why should we care? | *Student's own reasoning* |
| Key Fact #2 | A second fact that adds history or shows failed attempts | Timeline OR Failures OR Existing Efforts |
| Analysis of Fact #2 | What that fact means—why should we care? | *Student's own reasoning* |
| Summary | How these facts together prove action is needed | *Synthesis: Fact 1 + Fact 2 → therefore...* |

### Position Paragraph Ideas

| For Section → | Form This Idea | By Combining These (from L4) |
|---------------|----------------|------------------------------|
| Intro Sentence | Signal that your country is now stating its view | *Transition phrase* |
| Position Statement | What your country thinks should be done about this issue | Country's Past Positions + Country's Interests |
| Evidence | A fact that backs up your country's stance | UN Actions OR Success Stories OR Country's Involvement |
| Analysis | Why this evidence supports your position | *Student's own reasoning* |
| Reasoning | How this connects to your country's values or interests | Country's Interests + Country's Allies |

### Solutions Paragraph Ideas

| For Section → | Form This Idea | By Combining These (from L4) |
|---------------|----------------|------------------------------|
| Intro Sentence | Shift from "what we believe" to "what we should do" | *Transition phrase* |
| Solution Proposal | A specific action the international community should take | Success Stories + Country's Interests + Existing Efforts |
| Evidence | Proof that similar solutions have worked before | Success Stories OR Regional Efforts |
| Connection to Solution | Why the evidence shows your solution is realistic | *Student's own reasoning* |
| Alternate Solution | A second approach or fallback option | UN Actions OR Regional Efforts |

### Conclusion Paragraph Ideas

| For Section → | Form This Idea | By Combining These (from L4) |
|---------------|----------------|------------------------------|
| Summary of Key Evidence | The 2-3 facts that most strongly support your case | *Selected from earlier paragraphs* |
| Summary of Position | Your country's stance in simple terms | *Restated from Position Paragraph* |
| Summary of Proposed Solution | What should happen next | *Restated from Solutions Paragraph* |

---

## Layer 4: Background Guide Comprehension

This layer identifies the basic facts and comprehension tasks needed from the background guide before writing can begin.

### Topic Fundamentals
- **Topic Definition**: What is the issue in simple terms?
- **Key Terms**: Important vocabulary and their definitions
- **Scope**: Geographic/temporal boundaries of the topic

### Historical Context
- **Origin**: When and how did this issue emerge?
- **Timeline**: Major events in chronological order
- **Evolution**: How has the issue changed over time?

### Current Situation
- **Present State**: What is happening now?
- **Key Statistics**: Current numbers (affected people, costs, etc.)
- **Recent Developments**: Events from the past 1-2 years

### Stakeholders
- **Affected Populations**: Who is impacted and how?
- **Key Actors**: Countries, organizations, and groups involved
- **Power Dynamics**: Who has influence over this issue?

### Existing Efforts
- **UN Actions**: Relevant resolutions, treaties, agencies
- **Regional Efforts**: Regional organization initiatives
- **Success Stories**: What has worked (even partially)?
- **Failures**: What approaches have not worked and why?

### Points of Contention
- **Major Debates**: What do countries disagree about?
- **Competing Interests**: Economic, political, cultural factors
- **Barriers to Progress**: Why hasn't this been solved?

### Country-Specific Research
- **Country's Involvement**: Direct connection to the issue
- **Country's Past Positions**: Voting record, statements, actions
- **Country's Interests**: Why does this matter to them?
- **Country's Allies**: Who shares similar views?
- **Country's Constraints**: Economic, political, or social limitations

---

## Layer Mapping: How Layers Connect

```
Layer 4 (Raw Research)     →  Layer 3 (Formed Ideas)      →  Layer 2 (Sentences)  →  Layer 1 (Paper)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Bullet points, fragments   →  Complete thoughts/claims    →  Polished writing     →  Full paragraphs
Notes from background guide →  "I'm arguing that..."      →  Formal sentence      →  Connected sections
```

### Example Workflow

**Layer 4 (Research fragments):**
- "800 million people face hunger globally"
- "Climate change reducing crop yields"
- "FAO reports 10% increase since 2019"

**Layer 3 (Formed idea):**
> "Okay so hunger is actually getting worse, not better. 800 million people don't have enough food, and that number jumped 10% in just a few years. Climate change is part of why—it's messing with farming."

**Layer 2 (Polished sentence for "Key Fact #1"):**
> "Right now, over 800 million people around the world don't have enough to eat, and that number has jumped 10% since 2019, partly because climate change is making it harder to grow food."

**Layer 1 (In the Background Paragraph):**
> This sentence joins the rest of your Background Paragraph, flowing into your analysis and setting up your position.

---

## Workflow Summary

| Layer | Student Task | Output |
|-------|--------------|--------|
| **4** | Read background guide, extract key information | Notes, bullet points, quotes |
| **3** | Combine related notes into complete ideas | Rough claims/arguments in own words |
| **2** | Write each idea as a formal sentence | Draft sentences for each section |
| **1** | Assemble sentences into paragraphs | Complete position paper |

---

## AI Integration: Using Bookmarks to Assist Writing

The position paper writer has access to content the student bookmarked while reading the background guide. This section defines how AI should use that content to help—without taking over.

**Platform:** Cloudflare Workers AI (stateless inference API)

### Core Principles

1. **Student voice comes first.** The AI suggests, the student decides. Never auto-fill entire sentences without student input.
2. **Bookmarks are hints, not answers.** A bookmark means "this caught my attention"—it doesn't mean the student knows *why* it matters yet.
3. **Work at Layer 3, not Layer 2.** AI should help students form ideas, not write polished sentences for them.
4. **Show your work.** When suggesting content, show which bookmark(s) it came from so students can verify and learn.

---

### Technical Architecture

#### What Lives Where

| Component | Location | Why |
|-----------|----------|-----|
| Bookmark storage | Client (localStorage) or DB | Persists across sessions |
| Session state (current section, student inputs) | Client state | UI responsiveness |
| Layer 4 category tags | Computed at bookmark time | One-time classification |
| AI inference calls | Cloudflare Workers AI | Stateless, per-request |
| Prompt templates | Worker code | Version controlled |

#### Workers AI Constraints
- **Stateless:** No memory between calls—every request must include all needed context
- **Single response:** No back-and-forth conversation—each call returns one response
- **Context limits:** ~8K-128K tokens depending on model—bookmarks must be filtered/truncated
- **Latency:** Optimized for fast inference, but avoid unnecessary calls

---

### How Bookmarks Map to Layer 4 Categories

**When bookmarked:** Run a single classification call to tag the bookmark.

```
Prompt: Classify this text into one category: Key Statistics, Timeline,
Country Position, UN Actions, Points of Contention, Regional Efforts,
Affected Populations, or Other.

Text: "[bookmark text]"

Return only the category name.
```

**Fallback:** If classification fails or is ambiguous, let the student pick from a dropdown.

| Pattern hints (for faster regex pre-filter) | Likely category |
|---------------------------------------------|-----------------|
| Numbers, percentages, "X million" | Key Statistics |
| Years, "since [year]", "in [month]" | Timeline |
| Country + "voted", "supports", "opposes" | Country Position |
| "Resolution", "treaty", "UN", agency names | UN Actions |
| "However", "critics", "debate", "disagree" | Points of Contention |

---

### AI Assistance Modes

Each mode = one Workers AI call with a specific prompt template.

#### Mode 1: Filter Relevant Bookmarks (No AI needed)

**Implementation:** Client-side filtering based on Layer 4 tags.

When student opens a section, show bookmarks whose tags match that section's Layer 4 inputs (from the Layer 3 table).

**Example:** Student is writing "Key Fact #1"
- Layer 3 says: "By Combining: Key Statistics OR Present State"
- UI filters to show only bookmarks tagged `Key Statistics` or `Present State`

No AI call needed—just tag matching.

---

#### Mode 2: Summarize Selected Bookmarks (Single AI call)

**Trigger:** Student selects 2+ bookmarks and clicks "Help me combine these"

**Prompt template:**
```
You're helping a middle school student write a Model UN position paper.

They selected these bookmarks from their research:
{{#each selectedBookmarks}}
- "{{this.text}}" ({{this.category}})
{{/each}}

Summarize what these bookmarks are saying together in 1-2 casual sentences.
Use simple language. Don't write their paper for them—just help them see
the connection.

Start with "It sounds like..." or "So basically..."
```

**Example output:**
> "So basically, hunger is getting worse—800 million people affected, up 10% recently—and climate change is one of the reasons why."

---

#### Mode 3: Check Idea Against Bookmarks (Single AI call)

**Trigger:** Student writes a rough idea and clicks "Does my research support this?"

**Prompt template:**
```
A student is writing a position paper and drafted this idea:
"{{studentIdea}}"

Here are the bookmarks from their research:
{{#each allBookmarks}}
- "{{this.text}}" ({{this.category}})
{{/each}}

Which bookmarks (if any) support or relate to their idea?
List them with a brief explanation. If none relate, say so kindly.
Keep it short and encouraging.
```

**Example output:**
> "Your idea connects to these bookmarks:
> - '800 million people face food insecurity' — backs up 'hunger is a big problem'
> - 'Progress has stalled since 2020' — supports 'not enough is being done'
>
> You might also mention the Zero Hunger goal to show what was promised vs. what happened."

---

#### Mode 4: Draft Conclusion from Completed Sections (Single AI call)

**Trigger:** Student reaches Conclusion paragraph, clicks "Help me summarize"

**Prompt template:**
```
A student wrote these sections of their position paper:

**Key Facts:** {{backgroundFacts}}
**Position:** {{positionStatement}}
**Solution:** {{solutionProposal}}

Write a brief 2-3 sentence conclusion that summarizes these points.
Use their words where possible. Keep their voice—don't make it sound fancy.
```

**Example output:**
> "800 million people don't have enough to eat, and that number keeps growing. Brazil believes we need real action—not just more resolutions—like funding agricultural programs that actually work. It's time for countries to step up."

**UI:** Show as editable draft, not final text.

---

### What AI Should NOT Do

| Don't | Why | How we prevent it |
|-------|-----|-------------------|
| Auto-fill without student action | Removes learning | All AI requires button click |
| Hallucinate facts | Students can't verify | Prompts constrain to bookmark content only |
| Write full polished sentences | Takes over student voice | Prompts ask for summaries/connections, not prose |
| Multi-turn conversation | Workers AI is stateless | Each mode is single call with full context |

---

### Handling Edge Cases

**Not enough bookmarks for a section:**
- UI shows: "You don't have bookmarks tagged [category]. Want to go back to the background guide, or write from memory?"
- No AI call needed—this is just tag filtering.

**Too many bookmarks (context limit):**
- Limit to most recent 10-15 bookmarks per category
- Or let student manually select which to include

**Student writes something bookmarks don't support:**
- Mode 3 will say "I didn't find bookmarks that match this. That's okay—you might remember something you didn't bookmark. Want to add it as a note?"

---

### Prompt Design Guidelines

For all Workers AI calls:

1. **Include role context:** "You're helping a middle school student..."
2. **Constrain output:** "Keep it to 1-2 sentences" / "List only, no paragraphs"
3. **Set tone:** "Use simple language" / "Be encouraging"
4. **Prevent overreach:** "Don't write their paper" / "Help them see the connection"
5. **Ground in bookmarks:** Always include bookmark text in prompt so model can only reference what student actually found

---

### API Call Summary

| Mode | Trigger | Input | Output |
|------|---------|-------|--------|
| Classify bookmark | On bookmark creation | Bookmark text | Category tag |
| Filter bookmarks | On section open | Tags + current section | Filtered list (no AI) |
| Summarize selection | "Combine these" button | 2+ selected bookmarks | 1-2 sentence summary |
| Check idea | "Check my idea" button | Student text + all bookmarks | Matching bookmarks + suggestions |
| Draft conclusion | "Help summarize" button | Completed sections text | 2-3 sentence draft |

**Estimated calls per paper:**
- ~10-20 bookmark classifications (can batch or use regex fallback)
- ~3-5 summarize/check calls (student-initiated)
- ~1 conclusion draft
- **Total: ~15-25 API calls per paper**